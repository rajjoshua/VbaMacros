Sub ExtractApproversFromAttachment()

    Dim OlMail As Outlook.MailItem
    Dim objAttachment As Outlook.Attachment
    Dim WordDoc As Object
    Dim WordApp As Object
    Dim tbl As Object
    Dim row As Object
    Dim Approvers As String

    On Error Resume Next
    Set OlMail = Application.ActiveExplorer.Selection.Item(1)

    If Not OlMail Is Nothing Then
        For Each objAttachment In OlMail.Attachments
            If Right(objAttachment.FileName, 4) = ".doc" Or Right(objAttachment.FileName, 5) = ".docx" Then
                ' Save the attachment temporarily
                objAttachment.SaveAsFile Environ("Temp") & "\" & objAttachment.FileName

                ' Check if Word is already running
                Set WordApp = GetObject(, "Word.Application")
                If WordApp Is Nothing Then Set WordApp = CreateObject("Word.Application")

                Set WordDoc = WordApp.Documents.Open(Environ("Temp") & "\" & objAttachment.FileName)
                WordApp.Visible = False

                If WordDoc.Tables.Count >= 3 Then
                    Set tbl = WordDoc.Tables(3)
                    For Each row In tbl.Rows
                        If row.Cells(5).Range.Text = "X" & vbCr Then
                            Approvers = Approvers & row.Cells(1).Range.Text & vbNewLine
                        End If
                    Next row
                End If

                ' Close without saving and release objects
                WordDoc.Close wdDoNotSaveChanges
                Set WordDoc = Nothing

                ' Delete the temp file
                Kill Environ("Temp") & "\" & objAttachment.FileName
            End If
        Next objAttachment
    End If

    If Approvers <> "" Then
        MsgBox "List of Approvers:" & vbNewLine & Approvers, vbInformation, "Approvers"
    Else
        MsgBox "No Approvers found.", vbInformation, "No Approvers"
    End If

    Set OlMail = Nothing
    Set objAttachment = Nothing
    If Not WordApp Is Nothing Then WordApp.Quit
    Set WordApp = Nothing

End Sub
