Sub OpenAttachmentsAndFindApprovers()

'Declare variables
Dim olApp As Outlook.Application
Dim olMail As Outlook.MailItem
Dim olAttachment As Outlook.Attachment
Dim i As Long
Dim strSenderName As String
Dim strDocName As String
Dim doc As Word.Document
Dim table As Word.Table
Dim row As Word.TableRow
Dim cell As Word.TableCell
Dim names As Variant
Dim approvers As Variant

'Get the Outlook application object
Set olApp = Outlook.Application

'Get the selected mail item
Set olMail = olApp.ActiveExplorer.Selection.Item(1)

'Loop through all the attachments
For i = 1 To olMail.Attachments.Count

'Get the attachment object
Set olAttachment = olMail.Attachments(i)

'Open the attachment
olAttachment.Open

'Get the document name
strDocName = olAttachment.FileName

'Open the document
Set doc = Word.Documents.Open(strDocName)

'Find the 3rd table
Set table = doc.Tables(3)

'Loop through all the rows
For Each row In table.Rows

'Check if the cell in the 5th column is marked as X
If row.Cells(5).Value = "X" Then

'Get the name in the first column
names = row.Cells(1).Value

'Add the name to the list of approvers
If Not names Is Nothing Then
approvers = approvers & "," & names
End If

End If

Next row

'Close the document
doc.Close

Next i

'Check if the approvers list is not empty
If approvers <> "" Then

'Print the approver details in a message box
MsgBox "The approvers are: " & approvers

End If

End Sub
